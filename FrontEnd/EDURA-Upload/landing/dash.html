<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Edura - Child Dashboard</title>
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap">
  <style>
      :root {
  --primary: #6366f1;
  --primary-light: #818cf8;
  --primary-dark: #4f46e5;
  --secondary: #f97316;
  --secondary-light: #fb923c;
  --success: #10b981;
  --warning: #f59e0b;
  --danger: #ef4444;
  --info: #3b82f6;
  --background: #f8fafc;
  --foreground: #1e293b;
  --card: #ffffff;
  --card-foreground: #334155;
  --border: #e2e8f0;
  --input: #f1f5f9;
  --ring: rgba(99, 102, 241, 0.3);
  --radius: 0.75rem;
  --header-height: 60px;
  --sidebar-width: 240px;
}

.dark {
  --primary: #818cf8;
  --primary-light: #a5b4fc;
  --primary-dark: #4f46e5;
  --secondary: #fb923c;
  --secondary-light: #fdba74;
  --success: #34d399;
  --warning: #fbbf24;
  --danger: #f87171;
  --info: #60a5fa;
  --background: #0f172a;
  --foreground: #e2e8f0;
  --card: #1e293b;
  --card-foreground: #f1f5f9;
  --border: #334155;
  --input: #1e293b;
  --ring: rgba(129, 140, 248, 0.3);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Nunito', sans-serif;
  background-color: var(--background);
  color: var(--foreground);
  line-height: 1.5;
}

.dashboard {
  display: flex;
  min-height: 100vh;
}

/* Sidebar Styles */
.sidebar {
  width: var(--sidebar-width);
  background-color: var(--card);
  border-right: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  position: fixed;
  height: 100vh;
  z-index: 10;
  transition: transform 0.3s ease;
}

.logo {
  padding: 1.5rem;
  display: flex;
  align-items: center;
  justify-content: center;
  border-bottom: 1px solid var(--border);
}

.nav-menu {
  display: flex;
  flex-direction: column;
  padding: 1rem 0;
  flex: 1;
}

.nav-item {
  display: flex;
  align-items: center;
  padding: 0.75rem 1.5rem;
  color: var(--card-foreground);
  text-decoration: none;
  transition: all 0.2s ease;
  border-left: 3px solid transparent;
  gap: 0.75rem;
}

.nav-item:hover {
  background-color: var(--input);
}

.nav-item.active {
  border-left-color: var(--primary);
  background-color: var(--input);
  color: var(--primary);
}

.nav-item .icon {
  width: 20px;
  height: 20px;
}

.logout-container {
  padding: 1rem 1.5rem;
  border-top: 1px solid var(--border);
}

.logout-btn {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  width: 100%;
  padding: 0.75rem;
  border-radius: var(--radius);
  background-color: transparent;
  color: var(--danger);
  border: 1px solid var(--border);
  cursor: pointer;
  transition: all 0.2s ease;
}

.logout-btn:hover {
  background-color: var(--input);
}

/* Main Content Styles */
.main-content {
  flex: 1;
  margin-left: var(--sidebar-width);
  padding: 1.5rem;
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2rem;
}

.search-bar {
  display: flex;
  align-items: center;
  background-color: var(--input);
  border-radius: var(--radius);
  padding: 0.5rem 1rem;
  width: 300px;
}

.search-bar input {
  background: transparent;
  border: none;
  outline: none;
  padding: 0.5rem;
  width: 100%;
  color: var(--foreground);
}

.notification-btn {
  position: relative;
  background: transparent;
  border: none;
  cursor: pointer;
  padding: 0.5rem;
  border-radius: 50%;
  transition: background-color 0.2s ease;
}

.notification-btn:hover {
  background-color: var(--input);
}

.notification-badge {
  position: absolute;
  top: 0;
  right: 0;
  background-color: var(--danger);
  color: white;
  font-size: 0.75rem;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Profile Section */
.profile-section {
  margin-bottom: 2rem;
}

.profile-card {
  background-color: var(--card);
  border-radius: var(--radius);
  padding: 2rem;
  display: flex;
  align-items: center;
  gap: 2rem;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
  animation: fadeIn 0.5s ease;
}

.avatar-container {
  position: relative;
}

.avatar {
  width: 120px;
  height: 120px;
  border-radius: 50%;
  overflow: hidden;
  border: 4px solid var(--primary);
  box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.2);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.avatar:hover {
  transform: scale(1.05);
  box-shadow: 0 0 0 6px rgba(99, 102, 241, 0.3);
}

.avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.level-badge {
  position: absolute;
  bottom: 0;
  right: 0;
  background-color: var(--secondary);
  color: white;
  font-size: 0.75rem;
  font-weight: bold;
  padding: 0.25rem 0.5rem;
  border-radius: 1rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.user-info {
  flex: 1;
}

.username {
  font-size: 1.75rem;
  font-weight: 700;
  margin-bottom: 0.25rem;
  color: var(--card-foreground);
}

.grade {
  font-size: 1rem;
  color: var(--card-foreground);
  opacity: 0.8;
  margin-bottom: 1rem;
}

.coins-container {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  background-color: var(--input);
  padding: 0.5rem 1rem;
  border-radius: 2rem;
  width: fit-content;
  
}

.coins {
  font-weight: 600;
  color: var(--secondary);
}

/* Stats Section */
.stats-section {
  margin-bottom: 2rem;
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}

.section-header h2 {
  font-size: 1.25rem;
  font-weight: 600;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
}

.stat-card {
  background-color: var(--card);
  border-radius: var(--radius);
  padding: 1.5rem;
  display: flex;
  align-items: center;
  gap: 1rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  animation: slideUp 0.5s ease;
}

.stat-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
}

.stat-icon {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
}

.stat-icon.games {
  background-color: var(--primary);
}

.stat-icon.quizzes {
  background-color: var(--success);
}

.stat-icon.streak {
  background-color: var(--warning);
}

.stat-icon.accuracy {
  background-color: var(--info);
}

.stat-info {
  flex: 1;
}

.stat-info h3 {
  font-size: 0.875rem;
  font-weight: 600;
  margin-bottom: 0.25rem;
  color: var(--card-foreground);
  opacity: 0.8;
}

.stat-value {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--card-foreground);
}
.coins-earned {
  display: flex;
  align-items: center;
  gap: 8px;
  background-color: rgba(255, 215, 0, 0.2); /* Light gold background */
  padding: 5px 10px;
  border-radius: 20px;
  font-weight: bold;
}

.coin-icon {
  stroke: gold; /* Gold outline for the coin */
}

.coin-text {
  color: gold;
  font-size: 16px;
}


/* History Section */
.history-section {
  margin-bottom: 2rem;
}

.tab-buttons {
  display: flex;
  gap: 1rem;
}

.tab-btn {
  background: none;
  border: none;
  padding: 0.5rem 1rem;
  font-size: 0.875rem;
  font-weight: 600;
  color: var(--card-foreground);
  opacity: 0.7;
  cursor: pointer;
  border-bottom: 2px solid transparent;
  transition: all 0.2s ease;
}

.tab-btn.active {
  color: var(--primary);
  opacity: 1;
  border-bottom-color: var(--primary);
}

.tab-content {
  display: none;
  animation: fadeIn 0.3s ease;
}

.tab-content.active {
  display: block;
}

.history-list {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.history-item {
  background-color: var(--card);
  border-radius: var(--radius);
  padding: 1rem;
  display: flex;
  align-items: center;
  gap: 1rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  transition: transform 0.2s ease;
}

.history-item:hover {
  transform: translateX(5px);
}

.history-icon {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
}

.history-icon.math {
  background-color: var(--primary);
}

.history-icon.spelling, .history-icon.english {
  background-color: var(--info);
}

.history-icon.science {
  background-color: var(--success);
}

.history-icon.puzzle {
  background-color: var(--secondary);
}

.history-icon.geography {
  background-color: var(--warning);
}

.history-details {
  flex: 1;
}

.history-details h3 {
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 0.25rem;
}

.history-meta {
  font-size: 0.875rem;
  color: var(--card-foreground);
  opacity: 0.7;
}

.history-score {
  text-align: right;
}

.score-badge {
  background-color: var(--input);
  padding: 0.25rem 0.75rem;
  border-radius: 1rem;
  font-weight: 600;
  font-size: 0.875rem;
  color: var(--primary);
  margin-bottom: 0.25rem;
}

.time-ago {
  font-size: 0.75rem;
  color: var(--card-foreground);
  opacity: 0.7;
}

/* Achievements Section */
.achievements-section {
  margin-bottom: 2rem;
}

.view-all {
  font-size: 0.875rem;
  color: var(--primary);
  text-decoration: none;
}

.achievements-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
}

.achievement-card {
  background-color: var(--card);
  border-radius: var(--radius);
  padding: 1.5rem;
  display: flex;
  align-items: center;
  gap: 1rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  transition: all 0.3s ease;
}

.achievement-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
}

.achievement-icon {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  background-color: var(--primary-light);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
}

.achievement-info h3 {
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 0.25rem;
}

.achievement-info p {
  font-size: 0.875rem;
  color: var(--card-foreground);
  opacity: 0.7;
}

/* Animations */
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Responsive Styles */
@media (max-width: 1024px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .achievements-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .sidebar {
    transform: translateX(-100%);
  }
  
  .sidebar.open {
    transform: translateX(0);
  }
  
  .main-content {
    margin-left: 0;
  }
  
  .profile-card {
    flex-direction: column;
    text-align: center;
    gap: 1rem;
  }
  
  .user-info {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  
  .coins-container {
    margin: 0 auto;
  }
}

@media (max-width: 640px) {
  .stats-grid {
    grid-template-columns: 1fr;
  }
  
  .achievements-grid {
    grid-template-columns: 1fr;
  }
  
  .search-bar {
    width: 200px;
  }
}
/*tongle*/
.toggle-container {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-top: 10px;
}

.toggle-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  background-color: #f1f5f9;
  color: #1e293b;
  padding: 10px 15px;
  border: 2px solid #64748b;
  border-radius: 8px;
  cursor: pointer;
  font-size: 16px;
  font-weight: bold;
  transition: all 0.3s ease;
}

.toggle-btn svg {
  stroke: #64748b;
}

.toggle-btn.active {
  background-color: #1e293b;
  color: #f8fafc;
  border-color: #1e293b;
}

.toggle-btn.active svg {
  stroke: #f8fafc;
}
/* Scrollable History Section */
.history-container {
  max-height: 500px; /* Set a max height */
  overflow-y: auto; /* Enable vertical scrolling */
  padding: 10px;
  background: transparent;
  border-radius: 10px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  overflow-x: hidden;
}
.history-container::-webkit-scrollbar {
  width: 8px; /* Scrollbar width */
}

.history-container::-webkit-scrollbar-track {
  background: #f1f5f9; /* Track color */
  border-radius: 10px;
}

.history-container::-webkit-scrollbar-thumb {
  background: #64748b; /* Scrollbar handle color */
  border-radius: 10px;
}

.history-container::-webkit-scrollbar-thumb:hover {
  background: #1e293b; /* Darker color on hover */
}

/* History Items */
.history-item {
  display: flex;
  align-items: center;
  background: --primary-light;
  padding: 15px;
  margin-bottom: 10px;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  transition: transform 0.2s ease-in-out;
}

.history-item:hover {
  transform: scale(1.02);
}

/* History Icons */
.history-icon {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: gold;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
}

/* History Details */
.history-details {
  flex: 1;
  padding: 0 15px;
}

/* Coins Earned */
.coins-earned {
  display: flex;
  align-items: center;
  gap: 8px;
  background-color: rgba(255, 215, 0, 0.2);
  padding: 5px 10px;
  border-radius: 20px;
  font-weight: bold;
}

.coins-earned svg {
  stroke: gold;
}

.coins-earned span {
  color: gold;
  font-size: 16px;
}

/* Styled Toggle Buttons */
/* Right-align Score */
.quiz-score {
  font-weight: bold;
  color: #16a34a; /* Green */
  margin-left: auto;
  padding-right: 15px;
}

a{
  color: #0f172a;
}
/*avatars*/
.avatars-section {
    max-width: 1000px;
    margin: 40px auto;
    padding: 30px;
    background-color: #e2e8f0;
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  }
  
  .section-header {
    text-align: center;
    margin-bottom: 30px;
  }
  
  .section-header h2 {
    font-size: 28px;
    color: --foreground;
    margin-bottom: 10px;
    font-weight: 700;
  }
  
  .section-description {
    color: #666;
    font-size: 16px;
    max-width: 600px;
    margin: 0 auto;
  }
  
  .avatars-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
  }
  
  .avatar-card {
    background-color: --background;
    border-radius: 12px;
    overflow: hidden;
    transition: all 0.3s ease;
    position: relative;
    cursor: pointer;
    border: 3px solid transparent;
  }
  
  .avatar-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
  }
  
  .avatar-card.selected {
    border-color: #4285f4;
    background-color: #e8f0fe;
  }
  
  .avatar-card.locked {
    opacity: 0.6;
    filter: grayscale(100%);
    cursor: not-allowed;
  }
  
  .avatar-card.locked::after {
    content: '🔒';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 32px;
    background-color: rgba(0, 0, 0, 0.5);
    color: white;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .avatar-image {
    width: 100%;
    padding: 20px;
    display: flex;
    justify-content: center;
    background-color: white;
  }
  
  .avatar-image img {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }
  
  .avatar-card:hover .avatar-image img {
    transform: scale(1.1);
  }
  
  .avatar-info {
    padding: 12px;
    text-align: center;
    background-color: #f8f9fa;
    border-top: 1px solid #eee;
  }
  
  .avatar-name {
    display: block;
    font-weight: 600;
    font-size: 16px;
    margin-bottom: 4px;
    color: #333;
  }
  
  .avatar-level {
    display: block;
    color: #777;
    font-size: 14px;
  }
  
  .avatar-selection-controls {
    text-align: center;
    margin-top: 20px;
  }
  
  .btn-save {
    background-color: #4285f4;
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 30px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 8px rgba(66, 133, 244, 0.3);
  }
  
  .btn-save:hover:not(:disabled) {
    background-color: #3367d6;
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(66, 133, 244, 0.4);
  }
  
  .btn-save:disabled {
    background-color: #ccc;
    cursor: not-allowed;
    box-shadow: none;
  }

  </style>
</head>
<body>
  <div class="dashboard">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="logo">
        <h1>EDURA</h1>
      </div>
      <nav class="nav-menu">
        <a href="#" class="nav-item active">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
          <span>Home</span>
        </a>
        <a href="#" class="nav-item">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><path d="M16 13H8"></path><path d="M16 17H8"></path><path d="M10 9H8"></path></svg>
          <span>Lessons</span>
        </a>
        <a href="roadmap.html" class="nav-item">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><circle cx="12" cy="12" r="10"></circle><path d="M12 6v6l4 2"></path></svg>
          <span>Roadmap</span>
        </a>
        
      </nav>
      <div class="logout-container">
        <button id="logout-btn" class="logout-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
          <span>Logout</span>
        </button>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <header class="header">
        <div class="search-bar">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
          <input type="text" placeholder="Search...">
        </div>
        <div class="notifications">
          <button class="notification-btn">
            
          </button>
        </div>
      </header>

      <!-- Profile Section -->
      <section class="profile-section">
        <div class="profile-card">
          <div class="avatar-container">
            <div class="avatar-container">
              <div class="avatar">
                  <img src="/placeholder.svg?height=150&width=150" alt="User Avatar">
              </div>
              <div class="level-badge">Level 1</div> <!-- Level will be updated dynamically -->
          </div>
          
          <div class="user-info">
            <h1 id="userName" class="username">Loading...</h1>
            <p id="userUsername" class="grade">@username</p>
            <p id="userGrade" class="grade">Grade: Loading...</p>

            <div class="coins-container">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"></path>
                    <path d="M12 18V6"></path>
                </svg>
                <span id="userCoins" class="coins">0 Coins</span>
            </div>
        </div>
        
        </div>
      </section>

      <!-- Stats Section -->
      <section class="stats-section">
        <div class="section-header">
          <h2>Your Progress</h2>
        </div>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon games">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M10 2v8.5a2.5 2.5 0 0 1-5 0V2"></path><path d="M7 2h7.5a2.5 2.5 0 0 1 0 5H7"></path><path d="M11 22v-8.5a2.5 2.5 0 0 1 5 0v8.5"></path><path d="M14 22h-7.5a2.5 2.5 0 0 1 0-5H14"></path></svg>
            </div>
            <div class="stat-info">
              <h3>Games Played</h3>
              <p class="stat-value">42</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon quizzes">
              
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M12 2v8"></path><path d="m4.93 10.93 1.41 1.41"></path><path d="M2 18h8"></path><path d="M12 22v-8"></path><path d="m19.07 10.93-1.41 1.41"></path><path d="M22 18h-8"></path><path d="M12 12v.01"></path></svg>
            </div>
            <div class="stat-info">
              <h3>Quizzes Completed</h3>
              <p class="stat-value quiz-count" >28</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon streak">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
            </div>
            <div class="stat-info">
              <h3>Day Streak</h3>
              <p class="stat-value" id="streakValue">7</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon accuracy">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
            </div>
            <div class="stat-info">
              <h3>Accuracy</h3>
              <p class="stat-value">85%</p>
            </div>
          </div>
        </div>
      </section>

      <!-- History Tabs -->
      <!-- History Section -->
      <section class="history-section">
        <div class="section-header">
            <h2>Your Activity</h2>
            <div class="toggle-container">
                <button id="gameHistoryBtn" class="toggle-btn active">
                    🎮 Game History
                </button>
                <button id="quizHistoryBtn" class="toggle-btn">
                    📝 Quiz History
                </button>
            </div>
        </div>
        <div class="history-container">
            <div class="history-list">
                <p>Loading history...</p>
            </div>
        </div>
    </section>
    
    
    


      <!-- Achievements Section -->
      <section class="avatars-section">
        <div class="section-header">
          <h2>Choose Your Avatar</h2>
          <p class="section-description">Select an avatar that represents you. Unlock more as you level up!</p>
        </div>
        
        <div class="avatars-grid">
          <div class="avatar-card" data-level="1">
            <div class="avatar-image">
              <img src="/avatars/1.png" alt="Avatar 1">
            </div>
            <div class="avatar-info">
              <span class="avatar-name">Rookie</span>
              <span class="avatar-level">Level 1</span>
            </div>
          </div>
          
          <div class="avatar-card" data-level="2">
            <div class="avatar-image">
              <img src="/avatars/2.png" alt="Avatar 2">
            </div>
            <div class="avatar-info">
              <span class="avatar-name">Explorer</span>
              <span class="avatar-level">Level 2</span>
            </div>
          </div>
          
          <div class="avatar-card" data-level="3">
            <div class="avatar-image">
              <img src="/avatars/3.png" alt="Avatar 3">
            </div>
            <div class="avatar-info">
              <span class="avatar-name">Adventurer</span>
              <span class="avatar-level">Level 3</span>
            </div>
          </div>
          
          <div class="avatar-card" data-level="4">
            <div class="avatar-image">
              <img src="/avatars/4.png" alt="Avatar 4">
            </div>
            <div class="avatar-info">
              <span class="avatar-name">Voyager</span>
              <span class="avatar-level">Level 4</span>
            </div>
          </div>
          
          <div class="avatar-card" data-level="5">
            <div class="avatar-image">
              <img src="/avatars/5.png" alt="Avatar 5">
            </div>
            <div class="avatar-info">
              <span class="avatar-name">Champion</span>
              <span class="avatar-level">Level 5</span>
            </div>
          </div>
          
          <div class="avatar-card" data-level="6">
            <div class="avatar-image">
              <img src="/avatars/6.png" alt="Avatar 6">
            </div>
            <div class="avatar-info">
              <span class="avatar-name">Master</span>
              <span class="avatar-level">Level 6</span>
            </div>
          </div>
          
          <div class="avatar-card" data-level="7">
            <div class="avatar-image">
              <img src="/avatars/7.png" alt="Avatar 7">
            </div>
            <div class="avatar-info">
              <span class="avatar-name">Legend</span>
              <span class="avatar-level">Level 7</span>
            </div>
          </div>
          
          <div class="avatar-card" data-level="8">
            <div class="avatar-image">
              <img src="/avatars/8.png" alt="Avatar 8">
            </div>
            <div class="avatar-info">
              <span class="avatar-name">Mythic</span>
              <span class="avatar-level">Level 8</span>
            </div>
          </div>
        </div>
        
        <div class="avatar-selection-controls">
          <button class="btn-save" disabled>Save Selection</button>
        </div>
      </section>
    </main>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const avatarCards = document.querySelectorAll(".avatar-card");
      const saveButton = document.querySelector(".btn-save");
      const profileAvatar = document.querySelector(".profile-card .avatar img");
  
      let selectedAvatar = null;
  
      // Load saved avatar from localStorage
      const savedAvatar = localStorage.getItem("userAvatar");
      if (savedAvatar) {
          profileAvatar.src = savedAvatar; // Update profile avatar
          avatarCards.forEach(card => {
              const imgSrc = card.querySelector("img").src;
              if (imgSrc === savedAvatar) {
                  card.classList.add("selected");
                  selectedAvatar = card;
                  saveButton.disabled = false;
              }
          });
      }
  
      // Function to handle avatar selection
      avatarCards.forEach(card => {
          card.addEventListener("click", function () {
              if (card.classList.contains("locked")) return; // Ignore locked avatars
  
              // Deselect the previous selection
              if (selectedAvatar) selectedAvatar.classList.remove("selected");
  
              // Select new avatar
              card.classList.add("selected");
              selectedAvatar = card;
              saveButton.disabled = false;
          });
      });
  
      // Save selected avatar to localStorage
      saveButton.addEventListener("click", function () {
          if (selectedAvatar) {
              const avatarSrc = selectedAvatar.querySelector("img").src;
  
              // Save avatar in localStorage
              localStorage.setItem("userAvatar", avatarSrc);
  
              // Update profile avatar
              profileAvatar.src = avatarSrc;
  
              // Visual feedback
              saveButton.textContent = "Saved!";
              setTimeout(() => {
                  saveButton.textContent = "Save Selection";
              }, 2000);
          }
      });
  });
    document.addEventListener("DOMContentLoaded", function () {
      // Get user level from DOM
      const userLevelElement = document.querySelector(".level-badge");
      let userLevel = 1; // Default to level 1
    
      if (userLevelElement) {
        // Extract numeric level value
        const levelText = userLevelElement.textContent.trim();
        const levelMatch = levelText.match(/\d+/);
        if (levelMatch) {
          userLevel = parseInt(levelMatch[0]);
        }
      }
    
      console.log("Current user level:", userLevel);
    
      const avatarCards = document.querySelectorAll(".avatar-card");
      const saveButton = document.querySelector(".btn-save");
      let selectedAvatar = null;
    
      // Initialize cards (lock/unlock based on level)
      avatarCards.forEach((card) => {
        const levelRequired = parseInt(card.getAttribute("data-level"));
    
        console.log(`Avatar: ${card.querySelector(".avatar-name").textContent}, Required Level: ${levelRequired}`);
    
        if (levelRequired > userLevel) {
          card.classList.add("locked");
          card.title = `Unlock at Level ${levelRequired}`;
        } else {
          card.classList.add("unlocked");
          card.title = `Available - Click to select`;
    
          card.addEventListener("click", function () {
            if (selectedAvatar) {
              selectedAvatar.classList.remove("selected");
            }
    
            card.classList.add("selected");
            selectedAvatar = card;
            saveButton.disabled = false;
          });
        }
      });
    
      // Save button functionality
      saveButton.addEventListener("click", function () {
        if (selectedAvatar) {
          const avatarSrc = selectedAvatar.querySelector("img").src;
          const avatarName = selectedAvatar.querySelector(".avatar-name").textContent;
    
          console.log(`Saving avatar: ${avatarName}, ${avatarSrc}`);
    
          // Update user avatar throughout the site
          const userAvatars = document.querySelectorAll(".user-avatar img, .avatar img, .profile-picture img");
          userAvatars.forEach((avatar) => {
            avatar.src = avatarSrc;
          });
    
          // Update avatar in the navbar/header
          const headerAvatar = document.querySelector(".header-avatar img, .navbar-avatar img");
          if (headerAvatar) {
            headerAvatar.src = avatarSrc;
          }
    
          // Save avatar selection in localStorage
          try {
            localStorage.setItem("userAvatar", avatarSrc);
            localStorage.setItem("userAvatarName", avatarName);
            console.log("Avatar saved to localStorage");
          } catch (e) {
            console.log("Could not save avatar to local storage");
          }
    
          // Visual feedback for successful save
          const originalText = saveButton.textContent;
          saveButton.textContent = "Saved!";
          saveButton.classList.add("saved");
    
          setTimeout(() => {
            saveButton.textContent = originalText;
            saveButton.classList.remove("saved");
          }, 2000);
        }
      });
    
      // Load saved avatar from localStorage
      try {
        const savedAvatar = localStorage.getItem("userAvatar");
        if (savedAvatar) {
          avatarCards.forEach((card) => {
            if (!card.classList.contains("locked")) {
              const cardImgSrc = card.querySelector("img").src;
              if (cardImgSrc === savedAvatar) {
                card.click();
              }
            }
          });
        }
      } catch (e) {
        console.log("Could not load avatar from local storage");
      }
    
      // Function to refresh avatar availability when level changes
      window.refreshAvatarAvailability = function () {
        console.log("Refreshing avatar availability");
    
        const updatedLevelElement = document.querySelector(".level-badge");
        let updatedLevel = 1;
    
        if (updatedLevelElement) {
          const levelText = updatedLevelElement.textContent.trim();
          const levelMatch = levelText.match(/\d+/);
          if (levelMatch) {
            updatedLevel = parseInt(levelMatch[0]);
          }
        }
    
        console.log("Updated user level:", updatedLevel);
    
        avatarCards.forEach((card) => {
          const levelRequired = parseInt(card.getAttribute("data-level"));
    
          if (levelRequired <= updatedLevel && card.classList.contains("locked")) {
            card.classList.remove("locked");
            card.classList.add("unlocked");
            card.title = `Available - Click to select`;
    
            console.log(`Unlocking avatar: ${card.querySelector(".avatar-name").textContent}`);
    
            card.addEventListener("click", function () {
              if (selectedAvatar) {
                selectedAvatar.classList.remove("selected");
              }
    
              card.classList.add("selected");
              selectedAvatar = card;
              saveButton.disabled = false;
            });
          }
        });
      };
    
      // Ensure avatars refresh on page load
      refreshAvatarAvailability();
    
      // Example: Call this function whenever level updates dynamically
      window.updateUserLevel = function (newLevel) {
        const levelBadge = document.querySelector(".level-badge");
        if (levelBadge) {
          levelBadge.textContent = `Level ${newLevel}`;
          console.log("User level updated to:", newLevel);
          refreshAvatarAvailability(); // 🔥 Ensure avatars update immediately
        }
      };
    });
    
    const baseUrl = "http://iiit1127.us-east-2.elasticbeanstalk.com";
      document.addEventListener('DOMContentLoaded', function() {
  // Tab functionality
  const tabButtons = document.querySelectorAll('.tab-btn');
  const tabContents = document.querySelectorAll('.tab-content');

  tabButtons.forEach(button => {
    button.addEventListener('click', () => {
      // Remove active class from all buttons and contents
      tabButtons.forEach(btn => btn.classList.remove('active'));
      tabContents.forEach(content => content.classList.remove('active'));
      
      // Add active class to clicked button
      button.classList.add('active');
      
      // Show corresponding content
      const tabId = button.getAttribute('data-tab');
      document.getElementById(`${tabId}-tab`).classList.add('active');
    });
  });
//update streak 

  // Mobile menu toggle
  // Mobile menu toggle
  const menuToggle = document.createElement('button');
  menuToggle.classList.add('menu-toggle');
  menuToggle.innerHTML = `
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon">
      <line x1="4" x2="20" y1="12" y2="12"></line>
      <line x1="4" x2="20" y1="6" y2="6"></line>
      <line x1="4" x2="20" y1="18" y2="18"></line>
    </svg>
  `;
  
  document.querySelector('.header').prepend(menuToggle);
  
  menuToggle.addEventListener('click', () => {
    document.querySelector('.sidebar').classList.toggle('open');
  });

  // Close sidebar when clicking outside of it
  document.addEventListener('click', (event) => {
    const sidebar = document.querySelector('.sidebar');
    const menuToggleBtn = document.querySelector('.menu-toggle');
    
    // Check if sidebar is open and click is outside sidebar and not on menu toggle button
    if (sidebar.classList.contains('open') && 
        !sidebar.contains(event.target) && 
        !menuToggleBtn.contains(event.target)) {
      sidebar.classList.remove('open');
    }
  });

  // Add close button to sidebar
  const sidebar = document.querySelector('.sidebar');
  const closeBtn = document.createElement('button');
  closeBtn.classList.add('sidebar-close');
  closeBtn.innerHTML = `
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="18" y1="6" x2="6" y2="18"></line>
      <line x1="6" y1="6" x2="18" y2="18"></line>
    </svg>
  `;
  sidebar.prepend(closeBtn);

  closeBtn.addEventListener('click', () => {
    sidebar.classList.remove('open');
  });

  // Add CSS for the new close button
  const sidebarStyle = document.createElement('style');
  sidebarStyle.textContent = `
    .sidebar-close {
      position: absolute;
      top: 10px;
      right: 10px;
      background: none;
      border: none;
      cursor: pointer;
      padding: 5px;
      display: none;
      z-index: 10;
    }
    
    .sidebar.open .sidebar-close {
      display: block;
    }
    
    @media (max-width: 768px) {
      .sidebar-close {
        display: block;
      }
    }
  `;
  document.head.appendChild(sidebarStyle);

  // Logout button functionality
  document.getElementById('logout-btn').addEventListener('click', function() {
    if (confirm('Are you sure you want to logout?')) {
      // Redirect to login page or perform logout action
      alert('Logged out successfully!');
      // window.location.href = 'login.html';
    }
  });

  // Animation for stats cards
  const statCards = document.querySelectorAll('.stat-card');
  statCards.forEach((card, index) => {
    card.style.animationDelay = `${index * 0.1}s`;
  });

  // Animation for history items
  const historyItems = document.querySelectorAll('.history-item');
  historyItems.forEach((item, index) => {
    item.style.animationDelay = `${index * 0.1}s`;
    item.classList.add('animate-in');
  });

  // Dark mode toggle (optional feature)
  const createDarkModeToggle = () => {
    const darkModeToggle = document.createElement('button');
    darkModeToggle.classList.add('dark-mode-toggle');
    darkModeToggle.innerHTML = `
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon">
        <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
      </svg>
    `;
    
    document.querySelector('.notifications').prepend(darkModeToggle);
    
    darkModeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark');
      
      // Update icon based on mode
      if (document.body.classList.contains('dark')) {
        darkModeToggle.innerHTML = `
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon">
            <circle cx="12" cy="12" r="4"></circle>
            <path d="M12 2v2"></path>
            <path d="M12 20v2"></path>
            <path d="m4.93 4.93 1.41 1.41"></path>
            <path d="m17.66 17.66 1.41 1.41"></path>
            <path d="M2 12h2"></path>
            <path d="M20 12h2"></path>
            <path d="m6.34 17.66-1.41 1.41"></path>
            <path d="m19.07 4.93-1.41 1.41"></path>
          </svg>
        `;
      } else {
        darkModeToggle.innerHTML = `
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon">
            <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
          </svg>
        `;
      }
      
      // Save preference to localStorage
      localStorage.setItem('darkMode', document.body.classList.contains('dark'));
    });
    
    // Check for saved preference
    if (localStorage.getItem('darkMode') === 'true') {
      document.body.classList.add('dark');
      darkModeToggle.innerHTML = `
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon">
          <circle cx="12" cy="12" r="4"></circle>
          <path d="M12 2v2"></path>
          <path d="M12 20v2"></path>
          <path d="m4.93 4.93 1.41 1.41"></path>
          <path d="m17.66 17.66 1.41 1.41"></path>
          <path d="M2 12h2"></path>
          <path d="M20 12h2"></path>
          <path d="m6.34 17.66-1.41 1.41"></path>
          <path d="m19.07 4.93-1.41 1.41"></path>
        </svg>
      `;
    }
  };
  
  createDarkModeToggle();
  //streak
  

// Fetch streak when the page loads




  // Add hover effects for avatar
  const avatar = document.querySelector('.avatar');
  avatar.addEventListener('mouseover', function() {
    this.style.transform = 'scale(1.05) rotate(5deg)';
  });
  
  avatar.addEventListener('mouseout', function() {
    this.style.transform = 'scale(1)';
  });

  // Add confetti effect for achievements (optional)
  const achievementCards = document.querySelectorAll('.achievement-card');
  achievementCards.forEach(card => {
    card.addEventListener('click', function() {
      this.classList.add('achievement-clicked');
      setTimeout(() => {
        this.classList.remove('achievement-clicked');
      }, 700);
    });
  });

  // Add CSS for the new elements
  const style = document.createElement('style');
  style.textContent = `
    .menu-toggle {
      display: none;
      background: none;
      border: none;
      cursor: pointer;
      padding: 0.5rem;
    }
    
    .dark-mode-toggle {
      background: none;
      border: none;
      cursor: pointer;
      padding: 0.5rem;
      margin-right: 0.5rem;
      border-radius: 50%;
      transition: background-color 0.2s ease;
    }
    
    .dark-mode-toggle:hover {
      background-color: var(--input);
    }
    
    .animate-in {
      animation: slideIn 0.3s ease forwards;
      opacity: 0;
      transform: translateX(-20px);
    }
    
    @keyframes slideIn {
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    .achievement-clicked {
      animation: pulse 0.7s ease;
    }
    
    @keyframes pulse {
      0% {
        transform: scale(1);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      }
      50% {
        transform: scale(1.05);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      }
      100% {
        transform: scale(1);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      }
    }
    
    @media (max-width: 768px) {
      .menu-toggle {
        display: block;
      }
    }
  `;
  
  document.head.appendChild(style);
});
//api feature: username, coins
document.addEventListener("DOMContentLoaded", function () {
  const token = localStorage.getItem("token");
  const username = localStorage.getItem("loginUsername");

  if (token && username) {
      fetch(`http://iiit1127.us-east-2.elasticbeanstalk.com/childProfile/${username}`, {
          method: "GET",
          headers: {
              "Authorization": `Bearer ${token}`
          }
      })
      .then(response => {
          if (!response.ok) throw new Error(`Server error: ${response.status}`);
          return response.json();
      })
      .then(data => {
          const nameElement = document.getElementById("userName");
          const usernameElement = document.getElementById("userUsername");
          const coinsElement = document.getElementById("userCoins");

          if (nameElement) {
              let formattedName = data.name ? formatChildName(data.name) : formatChildName(username);
              nameElement.textContent = formattedName;
          }

          if (usernameElement) {
              usernameElement.textContent = `@${username}`;
          }

          if (coinsElement) {
              coinsElement.textContent = `${data.coins} Coins`;
              localStorage.setItem("userCoins", data.coins);
          }
      })
      .catch(error => {
          console.error("Error fetching data:", error);
      });
  }
});

// Function to format child name correctly and remove trailing numbers
function formatChildName(name) {
  return name
      .replace(/[_-]/g, " ") // Replace underscores and dashes with spaces
      .replace(/\d+$/, "") // Remove trailing numbers
      .split(" ") // Split into words
      .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()) // Capitalize each word
      .join(" "); // Rejoin as a full name
}
//logout
document.addEventListener("DOMContentLoaded", function () {
  const logoutButton = document.getElementById("logout-btn");

  if (logoutButton) {
      logoutButton.addEventListener("click", function () {
          const confirmLogout = confirm("Are you sure you want to log out?");
          if (confirmLogout) {
              // Clear stored user data
              localStorage.removeItem("token");
              localStorage.removeItem("loginUsername");
              localStorage.removeItem("userCoins");

              // Redirect to landing page
              window.location.href = "landingpage2.html";
          }
      });
  }
});
//get grade 
const apiBaseUrl = "http://iiit1127.us-east-2.elasticbeanstalk.com";

async function fetchUserGrade() {
  const username = localStorage.getItem("loginUsername");

  if (!username) {
      console.error("Username not found in localStorage");
      return;
  }

  try {
      const url = `http://iiit1127.us-east-2.elasticbeanstalk.com/child/${encodeURIComponent(username)}`;
      console.log("Fetching grade from:", url);

      const response = await fetch(url, { 
          method: "GET", 
          headers: { "Content-Type": "application/json" } 
      });

      if (!response.ok) {
          throw new Error(`API Error: ${response.status} ${response.statusText}`);
      }

      const userData = await response.json();
      let grade = userData.grade;

      // Convert grade number to readable format
      let gradeText = "Grade: Not Available";
      if (grade === 0) {
          gradeText = "Kindergarten";
      } else if (grade >= 1 && grade <= 5) {
          gradeText = `${grade}st Grade`;  // Default format
          if (grade === 2) gradeText = "2nd Grade";
          if (grade === 3) gradeText = "3rd Grade";
          if (grade > 3) gradeText = `${grade}th Grade`;
      }

      console.log("Grade loaded successfully:", gradeText);

      // Update grade in the UI
      const gradeElement = document.getElementById("userGrade");
      if (gradeElement) {
          gradeElement.textContent = gradeText;
      }

  } catch (error) {
      console.error("Error fetching grade:", error);
      const gradeElement = document.getElementById("userGrade");
      if (gradeElement) {
          gradeElement.textContent = "Grade: Not Available";
      }
  }
}

// Call the function when the page loads
document.addEventListener("DOMContentLoaded", fetchUserGrade);
async function fetchGameHistory() {
  const username = localStorage.getItem("loginUsername");
  if (!username) {
      console.error("Username not found in localStorage");
      return;
  }

  try {
      const url = `http://iiit1127.us-east-2.elasticbeanstalk.com/childProfile/${encodeURIComponent(username)}`;
      console.log("Fetching game history from:", url);

      const response = await fetch(url, { 
          method: "GET", 
          headers: { "Content-Type": "application/json" } 
      });

      if (!response.ok) {
          throw new Error(`API Error: ${response.status} ${response.statusText}`);
      }

      const data = await response.json();
      const gameRecords = data.gameRecords || [];

      // Process game history
      let history = [];
      let totalGamesPlayed = 0;

      gameRecords.forEach(record => {
          if (record.scoreHistory && Array.isArray(record.scoreHistory)) {
              totalGamesPlayed += record.scoreHistory.length;

              record.scoreHistory.forEach(entry => {
                  history.push({
                      game: record.game,
                      learning: record.learning,
                      timestamp: new Date(entry.timestamp)
                  });
              });
          }
      });

      // Sort the history by timestamp (latest first)
      history.sort((a, b) => b.timestamp - a.timestamp);

      // Create history HTML
      let historyHTML = history.map(item => `
          <div class="history-item">
              <div class="history-icon game">
                  <img src="./img/Learning-cuate.png" alt="Learning-cuate.png" width="50px"></img>
              </div>
              <div class="history-details">
                  <h3>${item.game}</h3>
                  <p class="history-meta">${item.learning}</p>
              </div>
              <div class="history-score">
                  <div class="coins-earned">
                      <svg class="coin-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="gold" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <circle cx="12" cy="12" r="10"></circle>
                          <path d="M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"></path>
                          <path d="M12 18V6"></path>
                      </svg>
                      <span class="coin-text">+30 Coins</span>
                  </div>
                  <p class="time-ago">${item.timestamp.toLocaleString()}</p>
              </div>
          </div>
      `).join('');

      // Update the UI
      document.querySelector(".history-list").innerHTML = historyHTML || "<p>No games played yet.</p>";

      // Update total games played in the stats section
      const gamesPlayedElement = document.querySelector(".stat-value");
      if (gamesPlayedElement) {
          gamesPlayedElement.textContent = totalGamesPlayed;
      }

  } catch (error) {
      console.error("Error fetching game history:", error);
      document.querySelector(".history-list").innerHTML = "<p>Failed to load game history.</p>";
  }
}

// Call the function when the page loads
document.addEventListener("DOMContentLoaded", fetchGameHistory);
async function updateUserLevel() {
    const username = localStorage.getItem("loginUsername");
    if (!username) {
        console.error("Username not found in localStorage");
        return;
    }
  
    try {
        const url = `http://iiit1127.us-east-2.elasticbeanstalk.com/childProfile/${encodeURIComponent(username)}`;
        console.log("Fetching user data from:", url);
  
        const response = await fetch(url, { 
            method: "GET", 
            headers: { "Content-Type": "application/json" } 
        });
  
        if (!response.ok) {
            throw new Error(`API Error: ${response.status} ${response.statusText}`);
        }
  
        const data = await response.json();
        const gameRecords = data.gameRecords || [];
  
        // Count total games played
        let totalGamesPlayed = 0;
        gameRecords.forEach(record => {
            if (record.scoreHistory && Array.isArray(record.scoreHistory)) {
                totalGamesPlayed += record.scoreHistory.length;
            }
        });
  
        // Calculate user level (1 level per 10 games)
        let userLevel = Math.max(1, Math.floor(totalGamesPlayed / 10));
  
        // Update level badge in UI
        const levelBadgeElement = document.querySelector(".level-badge");
        if (levelBadgeElement) {
            levelBadgeElement.textContent = `Level ${userLevel}`;
        }
  
        // ✅ Call `refreshAvatarAvailability()` to unlock avatars
        refreshAvatarAvailability();
  
    } catch (error) {
        console.error("Error updating user level:", error);
    }
  }
  
// Call the function when the page loads



// Call the function when the page loads
//accuracy
async function fetchUserAccuracy() {
  const username = localStorage.getItem("loginUsername");

  if (!username) {
      console.error("Username not found in localStorage");
      return;
  }

  try {
      const url = `http://iiit1127.us-east-2.elasticbeanstalk.com/leaderboard/accuracy/${encodeURIComponent(username)}`;
      console.log("Fetching accuracy from:", url);

      const response = await fetch(url, {
          method: "GET",
          headers: { "Content-Type": "application/json" }
      });

      if (!response.ok) {
          throw new Error(`API Error: ${response.status} ${response.statusText}`);
      }

      const data = await response.json();

      // Ensure accuracy is a number and format to two decimal places
      const accuracyValue = data.accuracy
          ? `${parseFloat(data.accuracy).toFixed(2)}%`
          : "N/A";

      console.log("Accuracy loaded successfully:", accuracyValue);

      // Update the accuracy in the UI
      const accuracyElement = document.querySelector(".stat-icon.accuracy + .stat-info .stat-value");
      if (accuracyElement) {
          accuracyElement.textContent = accuracyValue;
      }

  } catch (error) {
      console.error("Error fetching accuracy:", error);
      const accuracyElement = document.querySelector(".stat-icon.accuracy + .stat-info .stat-value");
      if (accuracyElement) {
          accuracyElement.textContent = "N/A";
      }
  }
}

// Call the function when the page loads
document.addEventListener("DOMContentLoaded", fetchUserAccuracy);

// Call the function when the page loads
document.addEventListener("DOMContentLoaded", fetchUserAccuracy);
async function fetchHistory(historyType = "game") {
  const username = localStorage.getItem("loginUsername");
  if (!username) {
      console.error("Username not found in localStorage");
      return;
  }

  let url = historyType === "quiz" 
      ? `http://iiit1127.us-east-2.elasticbeanstalk.com/leaderboard/history/${encodeURIComponent(username)}`
      : `http://iiit1127.us-east-2.elasticbeanstalk.com/childProfile/${encodeURIComponent(username)}`;

  try {
      console.log(`Fetching ${historyType} history from:`, url);
      const response = await fetch(url, { method: "GET", headers: { "Content-Type": "application/json" } });

      if (!response.ok) {
          throw new Error(`API Error: ${response.status} ${response.statusText}`);
      }

      const data = await response.json();
      let historyHTML = "";

      if (historyType === "quiz") {
          if (!data || data.length === 0) {
              historyHTML = "<p>No quiz history available.</p>";
          } else {
              historyHTML = data.map(quiz => `
                  <div class="history-item">
                      <div class="history-icon quiz-icon">📝</div>
                      <div class="history-details">
                          <h3>${quiz.category}</h3>
                      </div>
                      <div class="quiz-score">${quiz.score} Points</div>
                      <p class="time-ago">${new Date(quiz.timeDate).toLocaleString()}</p>
                  </div>
              `).join('');
          }

          const quizCountElement = document.querySelector(".stat-value.quiz-count");
          if (quizCountElement) {
              quizCountElement.textContent = data.length || 0;
          }

      } else {
          const gameRecords = data.gameRecords || [];
          let totalGamesPlayed = 0;
          let gameHistory = [];

          gameRecords.forEach(record => {
              if (record.scoreHistory && Array.isArray(record.scoreHistory)) {
                  totalGamesPlayed += record.scoreHistory.length;
                  record.scoreHistory.forEach(entry => {
                      gameHistory.push({
                          game: record.game,
                          learning: record.learning,
                          timestamp: new Date(entry.timestamp)
                      });
                  });
              }
          });

          gameHistory.sort((a, b) => b.timestamp - a.timestamp);

          if (gameHistory.length === 0) {
              historyHTML = "<p>No game history available.</p>";
          } else {
              historyHTML = gameHistory.map(item => `
                  <div class="history-item">
                      <div class="history-icon game-icon">🎮</div>
                      <div class="history-details">
                          <h3>${item.game}</h3>
                          <p>${item.learning}</p>
                      </div>
                      <div class="coins-earned">
                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="gold" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                              <circle cx="12" cy="12" r="10"></circle>
                              <path d="M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"></path>
                              <path d="M12 18V6"></path>
                          </svg>
                          <span>+30 Coins</span>
                      </div>
                      <p class="time-ago">${item.timestamp.toLocaleString()}</p>
                  </div>
              `).join('');
          }

          const gameCountElement = document.querySelector(".stat-value.game-count");
          if (gameCountElement) {
              gameCountElement.textContent = totalGamesPlayed;
          }
      }

      document.querySelector(".history-list").innerHTML = historyHTML;

  } catch (error) {
      console.error(`Error fetching ${historyType} history:`, error);
      document.querySelector(".history-list").innerHTML = `<p>Failed to load ${historyType} history.</p>`;
  }
}

// ✅ Fetch game history by default & update quiz count
document.addEventListener("DOMContentLoaded", () => {
  fetchHistory("game"); // Load game history first
  fetchHistory("quiz"); // Load quiz count immediately

  const gameBtn = document.getElementById("gameHistoryBtn");
  const quizBtn = document.getElementById("quizHistoryBtn");

  gameBtn.addEventListener("click", () => {
      fetchHistory("game");
      gameBtn.classList.add("active");
      quizBtn.classList.remove("active");
  });

  quizBtn.addEventListener("click", () => {
      fetchHistory("quiz");
      quizBtn.classList.add("active");
      gameBtn.classList.remove("active");
  });
});

// Event listener for toggle buttons
document.addEventListener("DOMContentLoaded", () => {
  fetchHistory("game");

  const gameBtn = document.getElementById("gameHistoryBtn");
  const quizBtn = document.getElementById("quizHistoryBtn");

  gameBtn.addEventListener("click", () => {
      fetchHistory("game");
      gameBtn.classList.add("active");
      quizBtn.classList.remove("active");
  });

  quizBtn.addEventListener("click", () => {
      fetchHistory("quiz");
      quizBtn.classList.add("active");
      gameBtn.classList.remove("active");
  });
});

// Event listener for toggle buttons
document.addEventListener("DOMContentLoaded", () => {
  fetchHistory("game"); // Default to game history

  const gameBtn = document.getElementById("gameHistoryBtn");
  const quizBtn = document.getElementById("quizHistoryBtn");

  gameBtn.addEventListener("click", () => {
      fetchHistory("game");
      gameBtn.classList.add("active");
      quizBtn.classList.remove("active");
  });

  quizBtn.addEventListener("click", () => {
      fetchHistory("quiz");
      quizBtn.classList.add("active");
      gameBtn.classList.remove("active");
  });
});
//streak


function fetchAndRenderStreak() {
  const username = localStorage.getItem("loginUsername");

  if (!username) {
    console.error("Username not found in localStorage");
    return;
  }

  console.log("Fetching streak for:", username); // Debugging log

  fetch(`${baseUrl}/streak/${username}`)
    .then(response => {
      console.log("API Response received:", response); // Debugging log
      return response.json();
    })
    .then(data => {
      console.log("Fetched Streak from API:", data);
      document.getElementById("streakValue").innerText = data;
    })
    .catch(err => {
      console.error("Error fetching streak:", err);
      document.getElementById("streakValue").innerText = "Error";
    });
}

// Run function when page loads
document.addEventListener("DOMContentLoaded", fetchAndRenderStreak);
document.addEventListener("DOMContentLoaded", updateUserLevel);

//avatar






  </script>
</body>
</html>